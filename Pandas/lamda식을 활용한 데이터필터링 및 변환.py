# ë¬¸ì œ 3: Lambdaì‹ì„ í™œìš©í•œ ë°ì´í„° í•„í„°ë§ ë° ë³€í™˜
# 5. ìµœì¢… ê²°ê³¼ë¥¼ "processed_students.csv" íŒŒì¼ë¡œ ì €ì¥í•˜ì„¸ìš”.

# ğŸ“Œ ë°ì´í„°
# ì´ë¦„(name)	ë‚˜ì´(age)	ë„ì‹œ(city)	ì ìˆ˜(score)
# ì² ìˆ˜	25	ì„œìš¸	90
# ì˜í¬	23	ë¶€ì‚°	85
# ë¯¼ìˆ˜	30	ëŒ€êµ¬	88
# ì§€ë¯¼	27	ì„œìš¸	95
# ìˆ˜í˜„	22	ë¶€ì‚°	80

# 1. ë°ì´í„°ë¥¼ DataFrameìœ¼ë¡œ ìƒì„±í•˜ì„¸ìš”.

import pandas as pd

data = {
    "ì´ë¦„(name)":["ì² ìˆ˜", "ì˜í¬", "ë¯¼ìˆ˜", "ì§€ë¯¼", "ìˆ˜í˜„"],
    "ë‚˜ì´(age)":[25, 23, 30, 27, 22],
    "ë„ì‹œ(city)": ["ì„œìš¸", "ë¶€ì‚°", "ëŒ€êµ¬", "ì„œìš¸", "ë¶€ì‚°"],
    "ì ìˆ˜(score)":[90, 85, 88, 95, 80]
}

df = pd.DataFrame(data)

# 2. ì ìˆ˜(score)ê°€ 85 ì´ìƒì¸ í•™ìƒë§Œ í•„í„°ë§í•˜ì„¸ìš”. (lambda ì‚¬ìš©)

filter_score = df.loc[df['ì ìˆ˜(score)'].apply(lambda x:x >= 85)]
print(filter_score)

# 3. ì´ë¦„(name) ì»¬ëŸ¼ì˜ ê°’ì„ ëª¨ë‘ ëŒ€ë¬¸ìë¡œ ë³€í™˜í•˜ì„¸ìš”. (lambda ì‚¬ìš©)

df["ì´ë¦„(name)"] = df["ì´ë¦„(name)"].apply(lambda x:x.upper())

# 4. **ë‚˜ì´(age)ê°€ 25 ì´ìƒì´ë©´ "ì„±ì¸", 
# ì•„ë‹ˆë©´ "ë¯¸ì„±ë…„"**ì´ë¼ëŠ” ìƒˆë¡œìš´ ì»¬ëŸ¼ **"êµ¬ë¶„(category)"**ì„ ì¶”ê°€í•˜ì„¸ìš”. (lambda ì‚¬ìš©)

# df["êµ¬ë¶„(category)"] = df['ë‚˜ì´(age)'].apply(lambda x : x >= 25)
df["êµ¬ë¶„(category)"] = df["ë‚˜ì´(age)"].apply(lambda x: "ì„±ì¸" if x >= 25 else "ë¯¸ì„±ë…„")
print(df)


# 5. ìµœì¢… ê²°ê³¼ë¥¼ "processed_students.csv" íŒŒì¼ë¡œ ì €ì¥í•˜ì„¸ìš”.
df.to_csv("processed_students.csv", index=False)